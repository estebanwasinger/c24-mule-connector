# Demonstration C24-iO Mule Connector Project

This directory contains a sample project which shows how to use the individual operations provided by the C24-iO Mule connector.



## Getting Started

1. Install the C24-iO Mule Connector. See [the C24-iO Mule Connector User Guide](http://dev.c24.biz/mule/usage.html) for details.
2. In your Anypoint Studio workspace, _Import_ an _Anypoint Studio Project from an External Location_.
3. Select this directory
4. Deselect _Copy Project into Workspace_ (alternatively, copy the contents of the lib directory manually after import)



## The Flow

src/main/app/mymuleproject.xml contains the example flow, the operation of which is:

1. File adapter to pick up inbound messages
2. C24-iO parse operation which converts the source message into a fully-bound Java representation.
3. C24-iO validate to ensure that the message is valid
4. C24-iO transform to convert from the source CustomerFile message to Contact Details
5. C24-iO marshal operation to marshal the result to a textual format
6. File adapter to write the resulting message to disk

The _convert_ operation could accomplish much of the above in a single step however we've used the lower-level operations for this example. 

Let's walk through each of the steps in detail:


### Inbound File Adapter

The adapter it setup to poll a directory (/tmp in this case) every second for files whose names end in ".xml". Matching files will be handed to the rest of the flow and deleted from disk.


### C24-iO Parse

The corresponding class for our inbound message format is _biz.c24.io.gettingstarted.customer.CustomersFile_ so that's what we set the _Type_ parameter to. This class (and the corresponding classes for the transform and output formats) were generated by C24-iO from our models. The jar for them is included with this project and if you look at the _pom.xml_ you'll see them included as a dependency (gettingstarted v1.0).

Our source message is stored in its default type and encoding so we can leave the remaining paramters blank. 


### C24-iO Validate

Validate will simply throw an exception if the message is invalid, so no further configuration is required.


### C24-iO Transform

This uses a C24-iO Transform to convert between models. The referenced _biz.c24.io.gettingstarted.transform.GenerateContactListTransform_ is a transform defined in the C24-iO Studio which converts our Customers File into a Contact Details list.


### C24-iO Marshal to Tag-Value

Marshaling converts our Java-based message back into a wire format. Here we're overriding the Contact Detail List's default output format to force a Tag-Value representation.


### Outbound File Adapter

The resulting message is written back to disk, using the inbound path but with ".txt" appended to the filename.



## Running the Flow

Right click on the mymuleproject.xml file and select _Run As_ -> _Mule Application with Maven_. Once Mule is up and running copy the Customers.xml file into /tmp (or whatever directory you've configured the inbound file adapter to poll).

If you have debug logging enabled, you'll see Mule pick up the file and run it through the flow. Once complete, look in the output directory (default also /tmp) for Customers.xml.txt to view the result of the transformation.


# Other Flows

## src/main/app/advancedtransform

This flow demonstrates using the transformAdvanced() operation which can handle multiple inputs to a transformation

## src/main/app/convertOperation

This flow demonstrates use of the convert() operation which is a convenience method encompassing parse/validate/transform/marshall
